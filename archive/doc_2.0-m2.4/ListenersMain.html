<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Jagger: User actions during the load test</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Jagger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<link href="tab-panel.css" rel="stylesheet" type="text/css">
  <script language="type="text/javascript"JavaScript" type="text/javascript" src="tab-panel.js">
  </script></head>
</head>
<body onload="bodyOnLoad()" onresize="raisePanel(currentMenuIndex)">
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ListenersMain.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">User actions during the load test </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a class="el" href="ListenersMain.html#section_listeners_intro">Additional user actions during performance test execution</a> </li>
<li><a class="el" href="ListenersMain.html#section_listeners_example">Listener example</a> </li>
<li><a class="el" href="ListenersMain.html#section_listeners_list">Listeners</a> </li>
<li><a class="el" href="ListenersMain.html#section_listeners_services">Services</a> </li>
<li><a class="el" href="ListenersMain.html#section_listeners_services_example">Service usage example</a></li>
</ul>
<h1><a class="anchor" id="section_listeners_intro"></a>
Additional user actions during performance test execution</h1>
<p>We consider that at this point, you have already <a class="el" href="WritingTest.html">learned how to write load test</a> and know the structure of the <a class="el" href="WritingTest.html#section_writing_test_load_scenario">load scenario</a> <br/>
 Execution of the load scenario can be described with following simplified sequence:</p>
<ul>
<li>Start the load scenario<ul>
<li>Start the first parallel test group inside scenario<ul>
<li>Start all load tests inside the test group</li>
<li>Provide SUT invocations (send requests to the SUT, work with the responses)</li>
<li>Stop all the tests</li>
</ul>
</li>
<li>Stop the first test group</li>
<li>Start the second tests group<ul>
<li>...</li>
</ul>
</li>
<li>Stop the second test group</li>
</ul>
</li>
<li>Stop the scenario</li>
</ul>
<p>Jagger allows to execute custom code on the every step from the list above. This code can prepare test data, reconfigure the SUT, store additional custom metrics, provide additional logging, etc <br/>
 The feature is available via <a class="el" href="ListenersMain.html#section_listeners_list">listeners</a> classes. User can implement his own listener (load scenario listener, test group listener, etc) and attach it to the particular element of the load scenario. <br/>
</p>
<h1><a class="anchor" id="section_listeners_example"></a>
Listener example</h1>
<dl class="section user"><dt>Create custom test group listener</dt><dd>In this simple example test group listener will just provide additional logging during test group start and stop  <div class="fragment"><div class="line"><span class="comment">/* begin: following section is used for docu generation - example of the test group listener */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>ExampleTestGroupListener <span class="keyword">extends</span> ServicesAware implements Provider&lt;TestGroupListener&gt; {</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Logger log = LoggerFactory.getLogger(ExampleTestGroupListener.class);</div>
<div class="line">    </div>
<div class="line">    @Override</div>
<div class="line">    <span class="keyword">protected</span> <span class="keywordtype">void</span> init() {</div>
<div class="line">        super.init();</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    @Override</div>
<div class="line">    <span class="keyword">public</span> TestGroupListener provide() {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> TestGroupListener() {</div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> onStart(TestGroupInfo infoStart) {</div>
<div class="line">                log.info(<span class="stringliteral">&quot;Started {} test group execution&quot;</span>, infoStart.getTestGroup().getTaskName());</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> onStop(TestGroupInfo infoStop) {</div>
<div class="line">                log.info(<span class="stringliteral">&quot;{} test group execution took {}ms&quot;</span>, infoStop.getTestGroup().getTaskName(), infoStop.getDuration());</div>
<div class="line">            }</div>
<div class="line">        };</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/* end: following section is used for docu generation - example of the test group listener */</span></div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>Attach test group listener to the parallel test group in your load scenario</dt><dd> <div class="fragment"><div class="line">        <span class="comment">// begin: following section is used for docu generation - example of the test group listener</span></div>
<div class="line"></div>
<div class="line">        JParallelTestsGroup jParallelTestsGroup = JParallelTestsGroup</div>
<div class="line">                .builder(Id.of(<span class="stringliteral">&quot;exampleJaggerParallelTestsGroup&quot;</span>), jLoadTest)</div>
<div class="line">                .addListener(<span class="keyword">new</span> ExampleTestGroupListener())</div>
<div class="line">                .build();</div>
<div class="line"></div>
<div class="line">        <span class="comment">// end: following section is used for docu generation - example of the test group listener</span></div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>Another example. Invocation listeners</dt><dd>You can attach as many listeners as necessary to particular step in the test flow. They will be executed in the same order like they are added<br/>
 Below is an example of the test definition with two invocation listeners  <div class="fragment"><div class="line">        <span class="comment">// begin: following section is used for docu generation - example of the invocation listener</span></div>
<div class="line">        JTestDefinition jTestDefinition = JTestDefinition</div>
<div class="line">                .builder(Id.of(<span class="stringliteral">&quot;exampleJaggerTestDefinition&quot;</span>), <span class="keyword">new</span> ExampleEndpointsProvider())</div>
<div class="line">                <span class="comment">// optional</span></div>
<div class="line">                .withComment(<span class="stringliteral">&quot;no comments&quot;</span>)</div>
<div class="line">                .withQueryProvider(<span class="keyword">new</span> ExampleQueriesProvider())</div>
<div class="line">                .addValidator(<span class="keyword">new</span> ExampleResponseValidatorProvider(<span class="stringliteral">&quot;we are always good&quot;</span>))</div>
<div class="line">                .addValidator(DefaultResponseValidatorProvider.of(NotNullResponseValidator.class))</div>
<div class="line">                .addValidator(JHttpResponseStatusValidatorProvider.of(200, 201, 204))</div>
<div class="line">                .addListener(<span class="keyword">new</span> NotNullInvocationListener())</div>
<div class="line">                .addListener(<span class="keyword">new</span> ExampleInvocationListener())</div>
<div class="line">                .build();</div>
<div class="line">        <span class="comment">// end: following section is used for docu generation - example of the invocation listener</span></div>
</div><!-- fragment --></dd></dl>
<h1><a class="anchor" id="section_listeners_list"></a>
Listeners</h1>
<dl class="section user"><dt>You can implement following listeners: </dt><dd><a class="el" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1collector_1_1loadscenario_1_1LoadScenarioListener.html">LoadScenarioListener</a> - Load scenario listener. Is triggered on start and stop of the load scenario <br/>
 <a class="el" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1collector_1_1testgroup_1_1TestGroupListener.html">TestGroupListener</a> - Parallel test group listener. Is triggered on start and stop of the test group <br/>
 <a class="el" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1collector_1_1test_1_1TestListener.html">TestListener</a> - Load test listener. Is triggered on start, stop and during load test execution <br/>
 <a class="el" href="group__Workaround__InvocationListener__group.html">InvocationListener</a> - Invocation listener. Is triggered on invocation start, success, error and failure <br/>
 <br/>
 </dd></dl>
<dl class="section user"><dt>Framework is providing additional information in the listeners: </dt><dd><a class="el" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1collector_1_1loadscenario_1_1LoadScenarioInfo.html">LoadScenarioInfo</a> - Load scenario listener. Is triggered on start and stop of the load scenario <br/>
 <a class="el" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1collector_1_1testgroup_1_1TestGroupInfo.html">TestGroupInfo</a> - Parallel test group listener. Is triggered on start and stop of the test group <br/>
 <a class="el" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1collector_1_1test_1_1TestInfo.html">TestInfo</a> - Load test listener. Is triggered on start, stop and during load test execution <br/>
 <a class="el" href="group__Workaround__InvocationInfo__group.html">InvocationInfo</a> - Invocation listener. Is triggered on invocation start, success, error and failure <br/>
 <br/>
 </dd></dl>
<dl class="section user"><dt>Java doc for listeners and examples</dt><dd><a class="el" href="group__Main__Listeners__group.html">Listener implementations and examples</a></dd></dl>
<h1><a class="anchor" id="section_listeners_services"></a>
Services</h1>
<p>In all listeners framework is providing access to the Jagger internals via services. Main goal of the services - simplify development of the custom code. With the help of services you can store custom metrics, access test results, store additional information about your test in the Jagger test results database <br/>
 </p>
<dl class="section user"><dt>You can use following services: </dt><dd><a class="el" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1services_1_1DefaultSessionInfoService.html">DefaultSessionInfoService</a> - Allows to add comments to the test results, mark results with tags <br/>
 <a class="el" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1services_1_1DefaultMetricService.html">DefaultMetricService</a> - Allows to crete and save custom metrics <br/>
 <a class="el" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1services_1_1DefaultDataService.html">DefaultDataService</a> - Provides access to the test results, stored in the results DB <br/>
 <br/>
 </dd></dl>
<dl class="section user"><dt>Java doc for services</dt><dd><a class="el" href="group__Main__Services__group.html">Service implementations and examples</a> <br/>
 </dd></dl>
<dl class="section user"><dt>Services availability</dt><dd>All custom listeners have access to Jagger services. List of available services can be different for different types of listeners. <br/>
 Please see table below to find what services can be used in different listeners. <br/>
  <div class="fragment"><div class="line">        <span class="comment">/* begin: following section is used for docu generation - listeners to services relation */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Services available for test listener */</span></div>
<div class="line">        <span class="keywordflow">if</span> (environment.equals(JaggerPlace.TEST_LISTENER)){</div>
<div class="line">            metricService       = <span class="keyword">new</span> DefaultMetricService(sessionId, taskId, context);       <span class="comment">/* Available */</span></div>
<div class="line">            sessionInfoService  = <span class="keyword">new</span> DefaultSessionInfoService(context);                     <span class="comment">/* Available */</span></div>
<div class="line">            dataService         = <span class="keyword">new</span> DefaultDataService(context);                            <span class="comment">/* Available */</span></div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* Services available for test group listener */</span></div>
<div class="line">        <span class="keywordflow">if</span> (environment.equals(JaggerPlace.TEST_GROUP_LISTENER)){</div>
<div class="line">            metricService       = <span class="keyword">new</span> DefaultMetricService(sessionId, taskId, context);       <span class="comment">/* Available */</span></div>
<div class="line">            sessionInfoService  = <span class="keyword">new</span> DefaultSessionInfoService(context);                     <span class="comment">/* Available */</span></div>
<div class="line">            dataService         = <span class="keyword">new</span> DefaultDataService(context);                            <span class="comment">/* Available */</span></div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* Services available for test suite listener */</span></div>
<div class="line">        <span class="keywordflow">if</span> (environment.equals(JaggerPlace.LOAD_SCENARIO_LISTENER)){</div>
<div class="line">            metricService       = <span class="keyword">new</span> EmptyMetricService(JaggerPlace.LOAD_SCENARIO_LISTENER); <span class="comment">/* NOT AVAILABLE */</span></div>
<div class="line">            sessionInfoService  = <span class="keyword">new</span> DefaultSessionInfoService(context);                     <span class="comment">/* Available */</span></div>
<div class="line">            dataService         = <span class="keyword">new</span> DefaultDataService(context);                            <span class="comment">/* Available */</span></div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* Services available for decision maker listener */</span></div>
<div class="line">        <span class="keywordflow">if</span> (environment.equals(JaggerPlace.TEST_GROUP_DECISION_MAKER_LISTENER)){</div>
<div class="line">            metricService       = <span class="keyword">new</span> EmptyMetricService(JaggerPlace.TEST_GROUP_DECISION_MAKER_LISTENER); <span class="comment">/* NOT AVAILABLE */</span></div>
<div class="line">            sessionInfoService  = <span class="keyword">new</span> DefaultSessionInfoService(context);                                 <span class="comment">/* Available */</span></div>
<div class="line">            dataService         = <span class="keyword">new</span> DefaultDataService(context);                                        <span class="comment">/* Available */</span></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Services available for invocation listener */</span></div>
<div class="line">        <span class="keywordflow">if</span> (environment.equals(JaggerPlace.INVOCATION_LISTENER)){</div>
<div class="line">            metricService       = <span class="keyword">new</span> DefaultMetricService(sessionId, taskId, context);         <span class="comment">/* Available */</span></div>
<div class="line">            sessionInfoService  = <span class="keyword">new</span> EmptySessionInfoService(JaggerPlace.INVOCATION_LISTENER); <span class="comment">/* NOT AVAILABLE */</span></div>
<div class="line">            dataService         = <span class="keyword">new</span> EmptyDataService(JaggerPlace.INVOCATION_LISTENER);        <span class="comment">/* NOT AVAILABLE */</span></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* end: following section is used for docu generation - listeners to services relation */</span></div>
</div><!-- fragment --> <br/>
 If you will try to use unavailable service in some listener - nothing will happen and warning will be logged <br/>
</dd></dl>
<h1><a class="anchor" id="section_listeners_services_example"></a>
Service usage example</h1>
<dl class="section user"><dt>Example of metric service usage in the invocation listener </dt><dd>Example code creates custom metric and stores test results to the Jagger database after every successful request to SUT  <div class="fragment"><div class="line"><span class="comment">/* begin: following section is used for docu generation - example of the invocation listener with metric service */</span></div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>NotNullInvocationListener <span class="keyword">extends</span> ServicesAware implements Provider&lt;InvocationListener&gt; {</div>
<div class="line"></div>
<div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String metricName = <span class="stringliteral">&quot;not-null-responses&quot;</span>;</div>
<div class="line"></div>
<div class="line">    @Override</div>
<div class="line">    <span class="keyword">protected</span> <span class="keywordtype">void</span> init() {</div>
<div class="line">        getMetricService().createMetric(<span class="keyword">new</span> MetricDescription(metricName).</div>
<div class="line">                                            displayName(<span class="stringliteral">&quot;Number of not null responses&quot;</span>).</div>
<div class="line">                                            showSummary(<span class="keyword">true</span>).</div>
<div class="line">                                            plotData(<span class="keyword">false</span>).</div>
<div class="line">                                            addAggregator(<span class="keyword">new</span> SumMetricAggregatorProvider()));</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    @Override</div>
<div class="line">    <span class="keyword">public</span> InvocationListener provide() {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> InvocationListener() {</div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> onStart(InvocationInfo invocationInfo) {</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> onSuccess(InvocationInfo invocationInfo) {</div>
<div class="line">                <span class="keywordflow">if</span> (invocationInfo.getResult() != null){</div>
<div class="line">                    getMetricService().saveValue(metricName, 1);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> onFail(InvocationInfo invocationInfo, InvocationException e) {</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> onError(InvocationInfo invocationInfo, Throwable error) {</div>
<div class="line">            }</div>
<div class="line">        };</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">/* end: following section is used for docu generation - example of the invocation listener with metric service */</span></div>
</div><!-- fragment --> <br/>
 </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jan 11 2017 16:22:08 for Jagger by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
